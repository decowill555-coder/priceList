<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>移动端商城演示</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- 顶部导航 -->
    <nav class="navbar">
        <div class="menu-btn" onclick="toggleSidebar()">
            <!-- SVG 菜单图标 -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="搜索商品..." oninput="handleSearch()">
        </div>
    </nav>

    <!-- 侧边栏覆盖层 -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- 左侧分类侧边栏 -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">商品分类</div>
        <ul class="category-list" id="categoryList">
            <!-- JS 动态生成 -->
        </ul>
    </aside>

    <!-- 右侧主要内容 -->
    <main class="main-content">
        <div class="product-grid" id="productGrid">
            <!-- JS 动态生成 -->
        </div>
    </main>

    <script>

        const imageFiles = [
            "AD钙奶-5-饮料.jpg",
            "AD钙奶220ml4瓶-8-饮料.jpg",
            "AD钙奶220ml24瓶-58-饮料.jpg",
            "AD钙奶水蜜桃味-5-饮料.jpg",
            "东鹏特饮250ml-3-饮料.jpg",
            "东鹏特饮500ml-5-饮料.jpg",
            "可乐罐装200ml-2.5-饮料.jpg",
            "可口可乐大瓶2L-7-饮料.jpg",
            "可口可乐系列300ml-2-饮料.jpg",
            "果粒橙1.25L-11-饮料.jpg",
            "果粒橙500ml-4-饮料.jpg",
            "果粒橙小瓶.jpg", // 注意：这个文件名不符合规则，没有价格和分类
            "红牛-5-饮料.jpg",
            "统一双萃1L-4-饮料.jpg",
            "统一双萃500ml-3-饮料.jpg",
            "统一系列瓶装1L-4-饮料.jpg",
            "统一系列瓶装500ml-3-饮料.jpg",
            "统一系列盒装-2-饮料.jpg",
            "统一系列罐装-2.5-饮料.jpg",
            "统一阿萨姆奶茶1.5L-11-饮料.jpg",
            "统一阿萨姆奶茶500ml-4-饮料.jpg",
            "脉动-5-饮料.jpg",
            "芬达大瓶2L-7-饮料.jpg",
            "茶π500ml-5-饮料.jpg",
            "营养快线-5-饮料.jpg",
            "营养快线原味-5-饮料.jpg",
            "营养快线白包装-5-饮料.jpg",
            "雪碧大瓶2L-7-饮料.jpg",
            "雪碧罐装200ml-2.5-饮料.jpg"
        ];

        

        let products = [];

        function parseFileName() {
            products = imageFiles.map(file => {
                // 1. 去掉 .jpg 后缀
                let baseName = file.replace('.jpg', '').replace('.jpeg', '').replace('.png', '');

                // 2. 按 "-" 分割
                // 注意：商品名里可能有"-"，所以我们只分割最后两部分（价格和分类）
                const parts = baseName.split('-');

                // 安全检查：如果分割后少于3部分，跳过或设置默认值
                if (parts.length < 3) {
                    console.warn(`文件名格式不正确，已跳过: ${file}`);
                    return null;
                }

                // 最后一部分是分类
                const category = parts.pop();
                // 倒数第二部分是价格
                const priceStr = parts.pop();
                // 剩下的所有部分合起来是商品名
                const name = parts.join('-');

                const price = parseFloat(priceStr); // 使用 parseFloat 支持小数价格
                if (isNaN(price)) {
                    console.warn(`价格解析失败，已跳过: ${file}`);
                    return null;
                }

                return {
                    id: Math.random().toString(36).substr(2, 9), // 生成随机ID
                    name: name.trim(),
                    price: price,
                    category: category.trim(),
                    image: `image/${category}/${file}`
                };
            }).filter(Boolean); // 过滤掉 null 值
        }

        // 分类定义
        const categories = [
            { id: "all", name: "全部商品" },
            { id: "饮料", name: "饮料" }
        ];

        // 状态变量
        let currentCategory = "all";
        let searchText = "";

        // DOM 元素
        const productGrid = document.getElementById('productGrid');
        const categoryList = document.getElementById('categoryList');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.querySelector('.sidebar-overlay');

        // 2. 初始化渲染
        function init() {
            parseFileName();
            renderCategories();
            renderProducts();
        }

        // 3. 渲染分类列表
        function renderCategories() {
            categoryList.innerHTML = categories.map(cat => `
                <li class="category-item ${cat.id === currentCategory ? 'active' : ''}" 
                    onclick="selectCategory('${cat.id}')">
                    ${cat.name}
                </li>
            `).join('');
        }

        // 4. 渲染商品列表 (核心逻辑)
        function renderProducts() {
            // 过滤逻辑
            const filteredData = products.filter(item => {
                // 分类匹配
                const isCategoryMatch = currentCategory === "all" || item.category === currentCategory;
                // 搜索词匹配
                const isSearchMatch = item.name.toLowerCase().includes(searchText.toLowerCase());
                return isCategoryMatch && isSearchMatch;
            });

            // 生成HTML
            if (filteredData.length === 0) {
                productGrid.innerHTML = '<div class="no-results">没有找到相关商品</div>';
            } else {
                productGrid.innerHTML = filteredData.map(item => `
                    <div class="product-card">
                        <div class="product-img">
                            <img src="${item.image}" alt="${item.name}" onerror="this.src='image/placeholder.jpg'">
                        </div>
                        <div class="product-info">
                            <div class="product-title">${item.name}</div>
                            <div class="product-price">¥${item.price}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // 5. 事件处理：选择分类
        function selectCategory(catId) {
            currentCategory = catId;
            renderCategories(); // 更新高亮
            renderProducts();   // 更新商品
            toggleSidebar();    // 选完自动关闭侧边栏
        }

        // 6. 事件处理：搜索
        function handleSearch() {
            const input = document.getElementById('searchInput');
            searchText = input.value.trim();
            renderProducts();
        }

        // 7. 交互：切换侧边栏
        function toggleSidebar() {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        // 辅助：生成随机浅色背景，让占位图好看点
        function getRandomColor() {
            const colors = ['#e3f2fd', '#f3e5f5', '#e8f5e9', '#fff3e0', '#fbe9e7', '#f5f5f5'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // 启动
        init();

    </script>
</body>

</html>